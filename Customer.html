<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Track Order - Noolithal</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{font-family:Arial;background:#eef2ff;margin:0;padding:15px}
.container{max-width:420px;margin:auto;background:#fff;padding:20px;border-radius:12px;box-shadow:0 5px 15px rgba(0,0,0,.1)}
h2{text-align:center}
input,button{width:100%;padding:12px;margin-top:10px;border-radius:6px;border:1px solid #ccc;font-size:15px}
button{background:#4f46e5;color:#fff;border:none;font-weight:bold;cursor:pointer}
.card{margin-top:20px;padding:15px;border-radius:10px;background:#f9fafb;border-left:6px solid #4f46e5;display:none}
.status{font-weight:bold}
.pending{color:orange}
.stitching{color:blue}
.ready{color:purple}
.delivered{color:green}
.paid{color:green}
.error{color:red;margin-top:10px;text-align:center}
.whatsapp{background:#25D366;margin-top:15px}
.footer{text-align:center;font-size:12px;margin-top:15px;color:#666}
</style>
</head>
<body>
<div class="container">
<h2>ðŸ“¦ Track Your Order</h2>
<input id="orderId" placeholder="Enter Order ID">
<input id="phone" placeholder="Enter Phone Number">
<button onclick="trackOrder()">Track Order</button>
<div class="error" id="error"></div>
<div class="card" id="resultCard">
<p><b>Order ID:</b> <span id="r_order"></span></p>
<p><b>Name:</b> <span id="r_name"></span></p>
<p><b>Status:</b> <span class="status" id="r_status"></span></p>
<p><b>Payment:</b> <span id="r_payment"></span></p>
<p><b>Amount:</b> â‚¹<span id="r_amount"></span></p>
<p><b>Delivery:</b> <span id="r_date"></span></p>
<button class="whatsapp" onclick="openWhatsApp()">ðŸ“± Contact on WhatsApp</button>
</div>
<div class="footer">Noolithal â€“ Crafting Dreams in Threads</div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyB4UcSI9a_AEYMVEqhENMCqzBdcXUX8jxI",
  authDomain: "noolithal-ecfc0.firebaseapp.com",
  projectId: "noolithal-ecfc0",
  storageBucket: "noolithal-ecfc0.firebasestorage.app",
  messagingSenderId: "663308298542",
  appId: "1:663308298542:web:d4a7a481350c4323ae72bf",
  measurementId: "G-N0Y1FLCSLY"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

let currentPhone = "";

async function trackOrder(){
  const orderId = document.getElementById("orderId").value.trim();
  const phone = document.getElementById("phone").value.trim();
  const error = document.getElementById("error");

  error.innerText = "";
  document.getElementById("resultCard").style.display="none";

  if(!orderId || !phone){
    error.innerText = "Please enter Order ID and Phone number";
    return;
  }

  try{
    const snap = await db.collection("orders")
      .where("orderId","==",orderId)
      .where("phone","==",phone)
      .get();

    if(snap.empty){
      error.innerText = "Order not found!";
      return;
    }

    const data = snap.docs[0].data();

    document.getElementById("r_order").innerText = data.orderId || "";
    document.getElementById("r_name").innerText = data.customerName || "";
    document.getElementById("r_payment").innerText = data.paymentStatus || "";
    document.getElementById("r_amount").innerText = data.amount || "";
    document.getElementById("r_date").innerText = data.deliveryDate || "";

    const statusEl = document.getElementById("r_status");
    const status = (data.status || "").toLowerCase();
    statusEl.innerText = data.status || "";
    statusEl.className = "status " + status;

    currentPhone = phone;
    document.getElementById("resultCard").style.display="block";

  }catch(err){
    console.log(err);
    error.innerText = "Error fetching order!";
  }
}

function openWhatsApp(){
  const msg = encodeURIComponent("Hello, I want to check my order status.");
  window.open("https://wa.me/91" + currentPhone + "?text=" + msg, "_blank");
}
</script>
</body>
</html>
